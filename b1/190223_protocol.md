Unicode的若干概念
==
可以把Unicode想成一本字典，规定了每个文字的映射(严格的说有些带声调的文字是组合出来的)。ASCII的删除键DEL编码是0x7F，在打孔机时代把字母全部重置，如果没见过纸带怕是理解不了的。

欧洲文字ISO8859定义了16个分部，但是要混打德文和俄文就不行了，于是2022规范引入了ESC转义规则，这套规则后来也被用在JIS和GB上。

截止1999年前，CJK统一汉字的范围是4E00-9FA5，用了基本面的20901个符号。后来又补充了若干编码，大多在基本面，少量在0x20000面，都是很少见的字。不严谨地说，用4E00-9FA5是足够用的。

首先每个字符是不是等宽，于是就有了宽字节和多字节的区分。宽字节的好处是查找统计反转方便，而多字节由于是变长，保存拉丁字母会省空间。因此宽内存多用于内存中的计算，而多字节用于存储或传输。Windows的API就是宽字节版。

BMP之前的宽字节方案，就称为UCS2，多字节编码是UTF8。随着UCS2不得换为更大集合，出现了UCS4方案，Windows为了保持和UCS2的兼容性，于是有了UTF16编码。它选取了UCS2一段不用的编码段来标识。而这个段的范围是1024x1024。这个范围等于17x65536，也就是现在字符集范围的来历。

正则匹配
--
pcre库为适应Unicode，加入了`\p`选项，支持pUnicode类名和p{Unicode}文字名两种模式。比如想匹配广义的数字，用`/\pN+/`，想匹配中文，用`\p{Han}`不用指定编码区间，全部交给底层文字引擎就可以了。

代理项对sorrogate pair
--
最初的1.0版本定义65536的集合大小，称为BMP。但是2006年中国要求所有软件支持GB18030，这个范围就不够了。这时就从BMP中把D800~DFFF这段区间保留下来不单独表示任何字符，专门用于转义扩展。这个区间又叫S区，共2048个字符。

转义时，D800到DBFF表示高10bit，DC00到DFFF表示低10bit，于是又能多表示16x65536个字符，再加上BMP。整个Unicode范围17个位面就是这么来的。