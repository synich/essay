协议为什么要分包
====
TCP是流式传输协议，每次在传输就要告知对端一个这次数据的长度，否则在流上无从断句。像HTTP就有Content-Length字段用于标识包长度。但是公司的协议除了总长度，还有分包长度，比如数据超过32K后，每次只发送32K，这个特性有什么意义呢？

这个特性和数据发送模型有关，公司协议是一条连接上可以并发地发送多条请求，即第一条请求的应答还没到，就可以发出第二个请求。HTTP则没有这个特性，HTTP的多请求利用同时创建多个TCP连接来实现。但是如果在一个连接上有多组请求应答，假设第一个应答有100K,第二个应答只有10字节，但是如果把第一个100K直接写入socket，再写入第二个10字节，则后面的10字节必须要等待100K发送完成才会继续发送，这对简单应答就很不利，所以强制将数据拆散32K,只要发送中途线程被调度到，就有机会把这10字节发出去，如此一来就可以尽早收到简短的回复包了。