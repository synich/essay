GB28181理解
====
全称由3个词组合，安全防范，视频监控，联网系统。视频监控领域的通用标准，用了信令SIP和媒体RTP/RTCP的模型。选用SIP是有多重原因

1. 视频监控有大量的视频数据要传输，而建立起这样一个视频会话，最现成的就是RTSP或者电话的SIP协议。
2. RTSP虽然是专为视频业务设计的协议，却基于一个前提，必须知道流源的地址。在中心化分发场景，多个客户端向一个流源请求视频是非常合适的。但是视频监控反过来，往往只有很少的客户端，却有大量潜在的摄像头，因此RTSP出局。
3. 要收集散落在各处的摄像头，需要向一个中心节点主动报备，恰巧SIP就有这个功能。

综上三点，SIP就奠定了在整个体系中的基础地位。

核心的SIP指令只有6条，INVITE、BYE、REGISTER、CANCEL、ACK、OPTIONS，相比H323简单很多。但SIP毕竟是用于建立电话的协议，视频监控还有很多的需求，好在有INFO和MESSAGE两个扩展，有了信令控制的基础，INFO具备改变会话的能力，典型应用是DTMF，即在电话中点击数字，所以用于回放控制是很自然的。而MESSAGE并不构成一次SIP的dialog，所以用在设备控制上，类似短连接语义。

除了请求应答模型，SIP还支持SUBSCRIBE/NOTIFY/PUBLISH模型，可以推送消息，甚至还有基于SIP的IM协议。

控制协议分请求和应答，请求有3种，Control, Query, Notify。应答是Response。体现在XML的最外层结构。

统一编码有A和B两种规范，前者20位，后者18位。我只见过A。编码即能表示设备又能表示用户。存储设备被称为前端主设备，而相机被称为前端外围设备。

目录概念解释

分设备目录和文件目录。设备目录包含3种:设备，区域，系统。文件只有1种:录像。每种都用一个complexType定义对象语义。业务上经常会订阅目录，发生变化后下级推送。

查录像协议很有特点，一个请求会有若干次的返回。一方面，MESSAGE请求本身就有应答，另外UDP受限于MTU无法携带大量消息，必须要分段传输。大华网关实现查目录，默认一次返回1条，可以配置一次返回5条。