# 笔记软件开发

整个2023年做了很多笔记方面的学习和思考，包括anki和tiddlywiki，但实践下来反而把自己的老本行给丢了。

我原来所有的数据都是基于sqlite的数据库，由于站点一度迁移到sdf，为了简化转变成用markdown加git管理。但是这个转变过程没有考虑一些私有文档，加上整个内容体系也梳理得不完整，所以一年多的工资都没有记录。最近几个月把pb完善的差不多，加上又学了全文检索，sdf的功能也支持数据库。所以还是想重新回归到数据库模式。回想半年前还做了很多从markdown写入数据库的工具，现在又要反过来写一遍，也是挺折腾的。

## 双链与标签编码

根据需求来设置目录，有名称需求，分类需求，主题需求。双链方便形成主题目录，但最终还是要靠个人整理

双链的心智负担还是有点重，因为双链需要手动去指定链接的目标。标签可以打多个，负担小，相应的需要对标签的用词比较精确（或至少前缀一致），但是好在可以通过词云的方式把历史标签整体罗列出来

## 自制tiddlywiki尝试

* 通过点击在当前节点前插入卡片

每个 DOM 节点都有`addEventListener`方法,遍历 DOM 树,对所有 a 节点添加 click 方法,回调函数的参数是 event 类型,用.target 取出 dom 元素

插入在前面,使用.before,尝试了 insertBefore 反而不行,不清楚原因

* 给div设置样式

由于 class 是关键字,用.className="xyz" 直接写类名,不要加点号

* 转换md到字符串

手写时发现`\n`要写成`\\n`,否则会报语法错误,应该还是和转义有关.用了 python 的`repr`方法搞定

* JS的分隔与换行

windows下cat会把换行符吞掉,导致多条 jctx.push 语句如果在一行会报错,不知道触发了哪个奇怪的规则,只能加分号规避

* 保存并下载文件

使用 Blob 类加上触发 a 标签动作

getElementsByTagName 返回多个元素,没搞明白,用 lastElementChild 代替

高度自适应,line-height 原理

写mytid时，投入了很大精力，但事后看来用的并不多。我觉得有两个原因，第1是编辑修改太不方便，第2个是外部的形态不是一个独立窗口，所以用起来不符合我的个人习惯，现在做一个本地GUI的，基于数据库的一个笔记。

经过一周开发出的GUI工具，做到除了几个长篇的内容外，都归集到1个数据库文件。好处是清爽简洁，但太依赖编辑工具，加上缺少内容预览能力，导致记录了近200篇内容但整理的时候没有着力点。笔记不同于日记，必须有主题而且便于回看，否则就成了没有整合的散乱数据。

## 引文

范冰对archive的4分类

1. AI Data Set,可自动提取
2. 简单已提过,但会被后人反复问的话题
3. 过期观点
4. 个人做过的项目和轨迹
