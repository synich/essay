# 一次打破表结构不动点设计的反思

做一个重点人标签功能，按最初的设计构想，感知数智的标签表，所有人员都有`profile_id`，因为每一个人都是通过聚档聚出来的，所以一定会有这个id，但是这次的需求就是要展示没有参与聚档的人员，这就带来了非常大的变动更，尝试了几种方案。

第1种，在标签表增加一个字段，这个是最容易想到的，但是由于标签表是有一个通用的labels字段，值如`{bqm1}{bqm5}`通过分词来实现标签检索。如果事后去看这个字段，就是一个特化的标签，设计会显得很不优雅，所以这个就被否决了。

第2种，考虑增加增加一种新的标签，这个时候人的`profile_id`还是没有办法，到底是用一个空串还是用一个特殊规则的假id呢？而这又带来了很大的争议，因为如果返回空串的话，其它接口很多地方会进行校验，空值又会报错，如果用一种带有规则的假破id，又显得非常的怪异。

通过增加一种新的标签，暂时解决了人在标签表的查询问题，接下来又面临一个新的问题，就是从标签是可以跳转到人员档案的，人员档案又是一张独立的表，但这个人并没有出现，这个跳转就会报错。这里最好的设计，应该是把标签跟人员档案合成一张表，但是因为历史原因，标签、档案、全息分是3张表，而且标签是在人员档案之后生成的，如果把标签里多出的人员又反写回人员档案，整个的流程会特别混乱。所以跳转动作又被web强制给拦截掉，没有办法做得非常统一和优雅。

之所以会这么拧吧，就是我们在一开始定义的时候，不动点假设被这个需求给击穿了，所以整个的设计要进行重新审视并要巧妙地打补丁。
