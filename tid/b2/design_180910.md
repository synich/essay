# 用数组实现链表

为每个链表元素分配一次空间对有洁癖的我来说太过累赘，更倾向用数组的连续性来得到这个特性。

直到看到s9的实现，才明白该其中决窍，引入一个和真实元素等长的标记可用数组，我称之为canuse，下标表示当前数组已使用或分配了多少个，再用一个整型值记录当前used个数。多出的canuse数组，类型选项uin8的话，可以将空间占用压到最少，代价就是每个块只有255，如果不够换uint16绰绰有余了。

初始化用canuse[i]=i。每次增加元素，只要used没到上限，自增后从对应canuse位置取得真正可用块。释放则反过来，把分配块的下标，放在canuse[used]位置，再将used减1，不需要释放内存。

上面的释放过程结束后，canuse数组元素内容从初始的顺序变乱序，但元素不会重复。这也要求决不允许同一个元素释放两次，目前没有做内部保护，要在外面清理。

另一点稍微不方便的是，分配出去的块，必须要记住在数组的什么位置，否则归还时无法建立正确的映射。